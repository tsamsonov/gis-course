---
title: "Основы геоинформатики"
subtitle: "Лекция 1: Основные понятия"
date: 10.02.2023
author: "Тимофей Самсонов"
execute:
  echo: false
engine: knitr
format:
  revealjs: 
    theme: [default, custom.scss]
    slide-number: true
bibliography: references.yaml
---

## Географическая информация

::: columns
::: {.column width="40%"}
![](images/image-1489181017.png)
:::

::: {.column width="60%"}

Географическая информация [@gost:19105-2003]

:   Информация об объектах и явлениях, содержащая в явном или неявном виде указание на их местоположение относительно Земли

**Пространственная привязка [@gost:70316-2022]**

:   Описание позиции в реальном виде
:::
:::

## Пространственная привязка

::: columns
::: {.column width="50%"}
**Абсолютная** привязка

1.  *Координаты* (59.926° с.ш., 30.339° в.д.)
2.  *Индекс* (191002)
3.  *Адрес* (Россия, г. Санкт-Петербург, улица Ломоносова, д.9)
4.  *Место* (Центральный район)
5.  *Объект* (корпус ИТМО)
:::

::: {.column width="50%"}
![](images/image-1646296081.png)
:::
:::

## Пространственная привязка

::: columns
::: {.column width="50%"}
**Относительная** привязка

1.  *Пространственные* отношения

    -   Метрические (600 метров от м. Владимирская)

    -   Топологические (примыкает к детскому саду №78)

    -   Дирекционные (на юго-восток от наб. Фонтанки)

2.  *Временные* отношения (в 15 мин. пешком от Витебского вокзала)
:::

::: {.column width="50%"}
![](images/image-1646296081.png)
:::
:::

## Географическая информация

::: columns
::: {.column width="50%" style="color: blue; text-align: end;"}
Динамическая

Оперативная

Массовая

Потоковая

Разнородная

Многомерная

Мультимасштабная

Волонтерская

Неопределенная

Синтезируемая
:::

::: {.column width="50%" style="color: grey"}
Статическая

Эпизодическая

Небольшого количества

Хранимая

Однородная

Двумерная, одномерная

Мономасштабная

Профессиональная

Определенная

Реальная
:::
:::

## Динамическая

Что может меняться у пространственного объекта?

::: columns
::: {.column width="30%"}
-   Геометрия

-   Местоположение

-   Внутренняя структура
:::

::: {.column width="70%"}
![Movebank --- трекинг перелетов птиц](images/image-1809566471.png)
:::
:::

## Динамическая

![Movebank --- трекинг перелетов птиц](images/image-42071914.png)

## Movebank {.white-text background-video="videos/movebank.mp4" background-video-muted="true"}

```{css}
.white-text, 
.white-text h2 {
 color: white;
 text-shadow: 2px 2px 2px black;
}
```

## Оперативная

Сервисы, основанные на местоположении (location-based services)

![](images/image-1484920162.png)

## Массовая

Географическая информация, генерируемая в большом объеме --- *большие данные (big data).*

![](images/image-1116401456.png)

## Потоковая

Географическая информация в процессе передачи.

![](images/image-1157146301.png)

## Векторные тайлы

Потоковые данные визуализируются на устройстве-получателе.

[![](images/image-1221494428.png)](https://www.mapbox.com)

## Мультимасштабная

Географическая информация во множестве уровней детализации.

::: columns
::: {.column width="60%"}
![](images/image-1857551106.png)
:::

::: {.column width="40%"}
![](images/image-271468979.png)
:::
:::

## Многомерная

Трёхмерная, трёхмерно-динамическая

[![](videos/ny-optimized.gif)](https://carto.com)

## Волонтёрская

*Volunteered geographic information (VGI)* --- географическая информация, создаваемая на добровольных началах

[![Российская сеть изучения и охраны пернатых хищников](images/image-955729548.png)](http://rrrcn.ru)

## OpenStreetMap

OpenStreetMap (OSM) --- крупнейший проект в области VGI

[![http://www.openstreetmap.org](images/image-1820088456.png)](http://www.openstreetmap.org)

## OpenStreetMap {.white-text background-video="videos/osm-edits.mp4" background-video-muted="true"}

## Неопределенная

Географическая информация, обладающая свойствами *непрецизионности, неточности и нечеткости.*

::: columns
::: {.column width="60%"}
![](images/image-288784986.png)
:::

::: {.column width="40%"}
![](images/image-1877121026.png)
:::
:::

## Синтезируемая

Географическая информация, полученная путем геосимуляций, геовычислений, геомоделирования.

::: columns
::: {.column width="50%"}
![](images/image-1127743790.png)
:::

::: {.column width="50%"}
![](images/image-2136309151.png)
:::
:::

## Геоинформатика

Геоинформатика (наука)

:   Наука о географической информации, методах ее получения, представления, хранения, обработки, анализа и распространения.

## Пространственный объект

Пространственный объект [@gost:52438-2005]

:   Цифровая модель материального или абстрактного объекта реального или виртуального мира с указанием его идентификатора, координатных и атрибутивных данных.

::: columns
::: {.column width="85%"}
::: callout-note
## Примечание

1.  Объектом может быть неподвижный или движущийся простой или сложный объект, явление, событие, процесс и ситуация.
2.  Моделируемый объект может относиться к территории, акватории, недрам и воздушному пространству Земли, околоземному космическому пространству, другим космическим телам и небесной сфере.
3.  В широком смысле под пространственным объектом в геоинформатике понимается как сам объект, так и адекватная ему цифровая модель.
:::
:::

::: {.column width="15%"}
```{mermaid}
classDiagram
class Feature{
    +int ID
    +list Attributes
    +geom Geometry
}
```
:::
:::

## Пространственные данные

Информация [@gost:7.0-99]

:   Сведения, воспринимаемые человеком и (или) специальными устройствами как отражение фактов материального или духовного мира в процессе коммуникации.

Данные [@gost:33707-2016]

:   Представление информации в формальном виде, пригодном для передачи, интерпретации или обработки людьми или компьютерами.

Пространственные данные [@gost:52438-2005]

:   Данные о пространственных объектах и их наборах.

## Онтология понятий

```{mermaid}
%%| fig-width: 11
flowchart LR
  A(Информация) --> B(Данные)
  C(Пространственный объект) --> D(Пространственные данные)
  A --> E(Географическая информация)
  B --> D
  E -.-> D
```

::: callout-note
## Примечание

**Пространственные данные** можно определить также как представление *географической* информации в формальном виде, пригодном для передачи, интерпретации или обработки людьми или компьютерами.
:::

## Географическая информационная система (ГИС)

Информационная система [@gost:7.0-99]

:   Система, предназначенная для хранения, обработки, поиска, распространения, передачи и представления информации

Географическая информационная система [@gost:52438-2005]

:   Информационная система, оперирующая пространственными данными.

::: callout-note
## Уточнение

ГИС можно определить систему, предназначенная для хранения, обработки, поиска, распространения, передачи и представления *географической* информации
:::

## Геоинформатика

Геоинформатика (отрасль) [@gost:52438-2005]

:   Научно-техническое направление, объединяющее:

    -   теорию цифрового моделирования предметной области с использованием пространственных данных;
    -   технологии создания и использования геоинформационных систем;
    -   производство геоинформационной продукции и оказание геоинформационных услуг.

::: callout-warning
## Будьте осторожны

В других сферах деятельности под аббревиатурой ГИС может подразумеваться *геофизическое исследование скважин*, *государственная информационная система* и т.д.
:::

## Три уровня моделирования

::: columns
::: {.column width="10%"}
```{mermaid}
%%| fig-width: 1
%%| fig-height: 6
flowchart TB
  A((1)) ---> B((2))
  B ---> C((3))
```
:::

::: {.column width="90%"}

Концептуальная модель [@gost:43.0.3-2009]

:   Абстрактная модель, определяющая структуру исследуемого объекта (составные части и связи), свойства составных частей, причинно-следственные связи

Модель пространственных данных [@lurie:2016]

:   Набор логических правил формализованного цифрового описания объектов реальности как пространственных объектов.

Модели пространственных объектов

:   Геометрические примитивы, используемые для координатного описания пространственных объектов или их частей.
:::
:::

## Концептуальные модели {.white-text background-image="images/image-1401221242.png"}

В реальном мире существует бесконечное разнообразие явлений.

## Концептуальные модели {.white-text background-image="images/image-633758101.png"}

**Объектно-ориентированная модель** используется когда явление интерпретируется как состоящее из дискретных объектов с четкими границами. *Характеристики объектов в пределах их границ предполагаются постоянными*.\
\
\
\
\
\
\

::: callout-tip
## Пример

Здания имеют четкие границы и моделируются как отдельные объекты
:::

## Концептуальные модели {.white-text background-image="images/image-1627346778.png"}

**Сетевая модель** используется для интерпретации явлений, состоящих из множества связанных между собой объектов. *Сетевая модель является производной от объектно-ориентированной*.

\
\
\
\
\
\
\

::: callout-tip
## Пример

Автомобильные дороги всегда образуют сетевую структуру
:::

## Концептуальные модели {.white-text background-image="images/image-1639184355.png"}

**Модель географических полей** используется для интерпретации явлений, *сплошным* образом покрывающих пространство. Как правило, моделируемая характеристика явления меняется *непрерывно*, но это не является обязательным условием.

\
\
\
\
\
\

::: callout-tip
## Пример

Земная поверхность имеет сплошной характер, ее высота меняется \[не\]прерывно
:::

## Концептуальные модели

Особенности концептуальных моделей географических явлений:

1.  Всегда являются *упрощением* реальности.

2.  Обобщают модели *картографической локализации* (по пунктам, на линиях, по площадям, рассеянной, сплошной).

3.  Выбираются в соответствии с масштабом и целью исследования, а также способом *интерпретации* явления.

    ::: callout-tip
    ## Пример

    Рельеф может рассматриватиься как совокупность форм (объектно-ориентированная модель) и как поверхность (модель географического поля).
    :::

4.  Определяют выбор *модели пространственных данных*.

## Модели пространственных данных

Модель пространственных данных определяется отображением множества объектов на множество значений их атрибутов.

::: columns
::: {.column width="50%"}
**Простой** **объект** имеет одно значение каждого атрибута.

::: callout-note
## Вектор (vector)

Данные, состоящие из простых объектов, называются **векторными**, т.к. с каждым объектом ассоциирован единственный *вектор* значений атрибутов.

![](images/simple_feature.svg){width="100%"}
:::
:::

::: {.column width="50%"}
**Сложный** **объект** имеет множест-во значений каждого атрибута.

::: callout-note
## Покрытие (coverage)

В *каждой* точке, принадлежащей объекту, существует уникальное значение каждого атрибута. Его можно запросить с помощью функции, которая называется **покрытием**.

![](images/complex_feature.svg){width="100%"}
:::
:::
:::

## Векторная модель

**Simple Features** --- стандарт @OGC2010, который определяет общую модель хранения и доступа к простым (векторным) объектам.

-   все геометрии состоят из точек;
-   все точки в геометрии имеют одинаковую размерность;
-   размерность точек может быть 2, 3 или 4.

В дополнение к обязательным измерениям $X$ и $Y$ *возможны*:

-   $Z$, обозначающее высоту
-   $M$, обозначающее некоторую меру --- например, время

Существует 4 варианта координат: $XY$, $XYZ$, $XYM$ и $XYZM$.

В географических координатах $X$ --- долгота, $Y$ --- широта.

## Векторная модель

Стандарт включает в себя **17 моделей пространственных объектов**.

::: columns
::: {.column width="50%"}
Основными являются 7 моделей:

-   **Линейно связные**: `POINT`, `LINESTRING`, `POLYGON`
-   **Линейно несвязные**: `MULTIPOINT`, `MULTIPOINT`, `MULTIPOLYGON`, `GEOMETRYCOLLECTION`
:::

::: {.column width="50%"}
::: callout-note
## Линейная связность

Линейно связным называется пространство, в котором любые две точки можно соединить непрерывной кривой.

![](images/connect.svg){width="60%"}
:::
:::
:::

Оставшиеся виды моделей включают: `CIRCULARSTRING`, `COMPOUNDCURVE`, `CURVEPOLYGON`, `MULTICURVE`, `MULTISURFACE`, `CURVE`, `SURFACE`, `POLYHEDRALSURFACE`, `TIN`, `TRIANGLE`.

## Векторная модель

![](images/simple_features.svg){width="100%"}

## Векторная модель

**Линейно связные** модели пространственных объектов.

| Тип          | Описание                                                                                                                                                                                                                                         |
|---------------------|---------------------------------------------------|
| `POINT`      | нуль-мерная геометрия, содержащая одну точку                                                                                                                                                                                                     |
| `LINESTRING` | последовательность точек, соединенных прямыми, несамопересекающимися отрезками; одномерная геометрия                                                                                                                                             |
| `POLYGON`    | геометрия с положительной площадью (двумерная); последовательность точек, отрезки между которыми формируют замкнутое кольцо без самопересечений; первое кольцо является внешним, ноль и более остальных колец представляют дырки внутри полигона |

## Векторная модель

**Линейно несвязные** модели пространственных объектов.

| Тип                  | Описание                                                                                                              |
|---------------------|---------------------------------------------------|
| `MULTIPOINT`         | множество точек; геометрия типа `MULTIPOINT` называется *простой* если ни одна пара точек в `MULTIPOINT` не совпадает |
| `MULTILINESTRING`    | множество линий                                                                                                       |
| `MULTIPOLYGON`       | множество полигонов                                                                                                   |
| `GEOMETRYCOLLECTION` | множество геометрий произвольного типа за исключением `GEOMETRYCOLLECTION`                                            |

## Хранение координат

```{r}
library(sf)
p = st_point(c(0.5,0.5))

pc = rbind(c(0.5,0.5), c(1, 3), c(2, 1), c(0.2, 2), c(2, 3), c(1.5, 1.5))
mp = st_multipoint(pc)

s1 = rbind(c(0,1),c(0.5,1.5),c(1.2,1.2),c(2,1.3),c(3,2))
ls = st_linestring(s1)

s1 = rbind(c(0.5,1.5),c(1.2,1.2),c(2,1.3))
s2 = rbind(c(0,1.5),c(0.5,2.0),c(1.2,1.7))
s3 = rbind(c(2,1.8),c(3,2.5))
mls = st_multilinestring(list(s1,s2,s3))

p1 = rbind(c(0.5,0.5), c(2,0), c(3,2), c(1.5,4), c(0,3), c(0.5,0.5))
p2 = rbind(c(1,1), c(0.8,2), c(2,2.2), c(1.4,1.1), c(1,1))
pol = st_polygon(list(p1, p2))
p3 = rbind(c(3,3.3), c(3.5, 3.1), c(4,3), c(4,3.7), c(3.7, 3.96), c(3.2,4), c(3,3.3))
p4 = rbind(c(3.2,3.4), c(3.8,3.2), c(3.8,3.7), c(3.3,3.8), c(3.2,3.4))
p5 = rbind(c(3,1.2), c(2.5,0.2), c(3.5,0.2), c(3.5,1.2), c(3,1.2))
p6 = rbind(c(0,1), c(0.1,0.8), c(0.2,0.5), c(0.1,0.3), c(0, 0.7), c(0,1))
mpol = st_multipolygon(list(list(p1,p2), list(p3,p4), list(p5), list(p6)))

gc = st_geometrycollection(list(pol, mp + c(3, -1), mls + c(2.5,2)))
```

**Well-Known Text (WKT)** --- текстовый формат

```{r}
cat(st_as_text(p))
cat(st_as_text(ls))
cat(st_as_text(pol))
cat(st_as_text(mp))
cat(st_as_text(mls))
cat(st_as_text(mpol))
cat(st_as_text(gc))
```

::: callout-note
## Назначение

Формат **WKT** используется в текстовых форматах файлов, а также для визуального анализа координат объектов. Он занимает много места в памяти компьютера и медленно читается/записывается программами.
:::

## Хранение координат

**Well-Known Binary (WKB)** --- бинарный формат

```{r}
cat('POINT:', st_as_binary(p))
cat('LINESTRING:', st_as_binary(ls))
cat('POLYGON:', st_as_binary(pol))
# cat(st_as_binary(mp))
# cat(st_as_binary(mls))
# cat(st_as_binary(mpol))
# cat(st_as_binary(gc))
```

::: callout-note
## Назначение

Формат **WKB** используется в бинарных форматах файлов, в том числе а базах данных. Он занимает мало места в памяти компьютера и быстро читается/записывается программами, но не подходит для визуального анализа.
:::

## Особенности векторной модели

1.  Используется для реализации объектно-ориентированной концептуальной модели.
2.  Основана на генерализации. Физическое или абстрактное тело представляется в виде конечного множества координат.
3.  В зависимости от уровня детализации один и тот же объект может представляться с помощью разной модели.
4.  Значения атрибутов в пределах границ каждого объекта предполагаются постоянными.

::: callout-warning
## Ограничение

Векторная модель не годится для представления *географических полей*.
:::

## Модель покрытий

::: columns
::: {.column width="60%"}
Модель покрытий предполагает, что можно представить поле изменения атрибутов внутри объектов.

::: callout-important
## Однако есть проблема

::: columns
::: {.column width="20%"}
![](images/rick_thinking.png)
:::

::: {.column width="80%"}
Географические поля определены на бесконечном множестве точек, в то время как любые модели данных состоят из конечного числа элементов. Как обойти это ограничение?
:::
:::
:::
:::

::: {.column width="40%"}
![](images/transform_cov.svg){width="45%"}
:::
:::

::: callout-tip
## Решение

Необходимо внутри объекта создать сетку опорных точек и определить функцию, которая сможет интерполировать значения между ними.
:::

## Триангуляционное покрытие

Построение покрытия начинается с простого объекта.

![](images/tin_details_1.svg){width="100%"}

## Триангуляционное покрытие

В объект добавляются известные значения геополя в точках.

![](images/tin_details_2.svg){width="100%"}

## Триангуляционное покрытие

Точки данных соединяются *сплошной* сеткой треугольников --- **триангуляцией**.

![](images/tin_details_3.svg){width="100%"}

## Триангуляционное покрытие

**Функция покрытия** реализуется путем линейной интерполяция поля внутри треугольников.

![](images/tin_details_4.svg){width="100%"}

## Триангуляционное покрытие

У каждого узла есть область влияния. Совокупность таких областей называется **диаграммой Вороного**.

![](images/tin_details_5.svg){width="100%"}

## Триангуляционное покрытие

Диаграмма Вороного дает альтернативную функцию покрытия, в которой поле считается *постоянным* в пределах областей.

![](images/tin_details_6.svg){width="100%"}

## Триангуляционное покрытие

Элементы триангуляционной модели имеют свои названия.

![](images/tin_details_7.svg){width="100%"}

## Растровое покрытие

В растровом покрытии множество узлов с данными поля упорядочивается в виде матрицы --- **растра**.

![](images/raster_details_1.svg){width="100%"}

## Библиография
