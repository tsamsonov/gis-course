{
  "hash": "8c9a5e5b009c72f53eaba3281124e0aa",
  "result": {
    "markdown": "---\ntitle: \"Создание объектов и пространственные отношения\"\nsubtitle: \"Основы геоинформатики. Лекция 2\"\ndate: 02/17/2023\ndate-format: long\nauthor: \"Самсонов Тимофей Евгеньевич\"\nexecute:\n  echo: false\n  freeze: true\nengine: knitr\nformat:\n  revealjs: \n    theme: [default, custom.scss]\n    margin: 0.2\n    slide-number: true\n    footer: \"Самсонов Т. Е. Основы геоинформатики: курс лекций для студентов географического факультета МГУ\"\n    header-includes: <link rel=\"stylesheet\" media=\"screen\" href=\"https://fontlibrary.org//face/pt-sans\" type=\"text/css\"/>\nbibliography: references.yaml\nmainfont: PT Sans\n---\n\n\n\n## Создание объектов\n\nСоздание векторных пространственных объектов осуществляется разными способами. Наиболее распространены:\n\n1.  **Автоматическое конструирование** на основе координат.\n\n2.  **Геокодирование** --- преобразование географических идентификаторов в координаты.\n\n3.  **Векторизация** --- создание объектов в ручном режиме, либо путем преобразования из других моделей данных.\n\n    ::: callout-tip\n    ## Уточнение\n\n    Векторизации-преобразованию обычно подвергаются растровые данные.\n    :::\n\n4.  **Геометрические операции** --- получение новых векторных объектов в результате операций над существующими объектами.\n\n## Автоматическое конструирование\n\n#### Маршрут --- линейный объект\n\n::: columns\n::: {.column width=\"50%\"}\n**Исходные данные**\n\n![](images/image-11396456.png)\n\n![](images/image-1313555464.png)\n:::\n\n::: {.column width=\"50%\"}\n**Simple Feature**\n\n```         \nGeometry set for 1 feature \nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 36.34891 ymin: 55.19607 xmax: 36.38429 ymax: 55.21918\nGeodetic CRS:  WGS 84\nLINESTRING (36.38314 55.20975, 36.38314 55.20976, 36.3832 55.20997, 36.38321 55.21001, 36.38321 55.21002, 36.38325 55.21007...\n```\n:::\n:::\n\n## Автоматическое конструирование\n\n#### Поле --- площадной объект\n\n::: columns\n::: {.column width=\"50%\"}\n**Исходные данные**\n\n![](images/image-587177276.png)\n\n![](images/image-635340267.png)\n:::\n\n::: {.column width=\"50%\"}\n**Simple Feature**\n\n```         \nGeometry set for 1 feature \nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 36.37781 ymin: 55.18984 xmax: 36.38543 ymax: 55.19887\nGeodetic CRS:  WGS 84\nPOLYGON ((36.38543 55.19842, 36.38538 55.19825, 36.38533 55.19806, 36.38528 55.19785, 36.38525 55.19763, 36.38513 55.19745,...\n```\n:::\n:::\n\n## Автоматическое конструирование\n\n#### Геодезические пункты --- точечные объекты\n\n::: columns\n::: {.column width=\"50%\"}\n**Исходные данные**\n\n![](images/image-1928425450.png)\n:::\n\n::: {.column width=\"50%\"}\n**Simple Feature**\n\n``` {style=\"font-size: 8\"}\nSimple feature collection with 2 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 36.34953 ymin: 55.19612 xmax: 36.37369 ymax: 55.2188\nGeodetic CRS:  WGS 84\nN Name    geometry\n  <chr>   <POINT [°]>\n1 Африка  (36.34953 55.19612)\n2 Сенокос (36.37369 55.2188)\n```\n:::\n:::\n\n## Автоматическое конструирование\n\n::: columns\n::: {.column width=\"60%\"}\n![](images/field_map.png)\n:::\n\n::: {.column width=\"40%\"}\nПример использования --- построение карт по результатам полевых работ.\n\n::: callout-caution\n## Ограничения\n\nСырые данные ГНСС-измерений содержат погрешности. Поэтому векторные объекты, созданные на их основе, часто нуждаются в редактировании, в том числе с использованием геометрических операций.\n:::\n:::\n:::\n\n## Географические идентификаторы\n\nУвязаны с местоположением, идентифицируемым географическими объектами. Взаимосвязь с объектом может быть установлена следующими основными способами:\n\n-   **локализацией**, когда конкретная позиция находится внутри географического объекта, например в стране;\n\n-   **локальными измерениями**, когда позиция определена относительно фиксированных точек географических объектов, например вдоль улицы на заданном расстоянии от пересечения с другой улицей. Этот аспект известен как *линейная привязка*;\n\n-   **слабо связанным способом**, когда позиция имеет нечеткую взаимосвязь с географическими объектами, например рядом со зданием или между двумя зданиями.\n\n## Геокодирование\n\nГеографический идентификатор [@gost:70316-2022]\n\n:   Пространственная привязка в виде текстового обозначения или кода, определяющего местоположение\n\nГеографический справочник (газеттир)\n\n:   Реестр экземпляров местоположений одного или более подтипов местоположений, содержащих некоторую информацию о позиции.\n\n::: callout-note\n## Адресный локатор\n\nГеографический справочник почтовых адресов и их местоположения обычно называют *адресным локатором*.\n:::\n\n## Адресное геокодирование\n\n\n\n```{mermaid}\n%%| fig-width: 11\nflowchart LR\n  A(Адрес) --> B(Геокодер)\n  C(Адресный локатор) --> B\n  B --> D(Координаты)\n```\n\n\n\n**Адресный локатор** хранит набор набор векторных объектов, для каждого из которых задано структурированное описание адреса, разбитое на компоненты: индекс, регион, нас. пункт, улица и т.д.\n\n**Геокодер** находит в локаторе наиболее вероятное местоположение, соответствующее переданному адресу.\n\n## Адресное геокодирование\n\nАдресное геокодирование позволяет автоматизировать преобразование текстовых данных в пространственные.\n\n::: columns\n::: {.column width=\"45%\"}\n**Исходные данные**\n\n![](images/addr_source.png){width=\"90%\"}\n:::\n\n::: {.column width=\"55%\"}\n**Результаты геокодирования**\n\n![](images/addr_res.png){width=\"90%\"}\n:::\n:::\n\n## Векторизация\n\n**Векторизация** может осуществляться в автоматическом, автоматизированном и ручном режиме.\n\n-   *Автоматическая векторизация* используется, например, при конвертации покрытий, хранящих категориальные данные, в набор векторных объектов.\n\n    ![](images/vectorize.svg){width=\"65%\"}\n\n## Векторизация\n\n**Векторизация** может осуществляться в автоматическом, автоматизированном и ручном режиме.\n\n-   *Автоматизированная векторизация* используется, например, при выделении объектов на космических снимках и сканированных картах. Результирующие объекты требуют редактирования.\n\n    ![](images/image-91314596.png)\n\n    @yurtseven2019\n\n## Векторизация\n\n**Векторизация** может осуществляться в автоматическом, автоматизированном и ручном режиме.\n\n::: columns\n::: {.column width=\"30%\"}\n![](images/vec_manual_crop.gif)\n:::\n\n::: {.column width=\"70%\"}\n-   *Ручная векторизация* используется, когда автоматизированные методы не дают удовлетворительного результата, или когда надо создать новый векторный объект, для которого нет образца.\n\n::: callout-tip\n## Операции редактирования\n\nРучная векторизация похожа на работу в векторных графических редакторах. Объекты можно не только создавать, но также разрезать, присоединять, вырезать в них дырки и т.д.\n:::\n:::\n:::\n\n## Цифрование\n\nЦифрование\n\n:   Получение цифрового представления объектов.\n\n::: callout-tip\n## Пример\n\nКлассические пример цифрования --- получение растра топографической карты по результатам сканирования.\n:::\n\n::: callout-warning\n## Соотношение с векторизацией\n\n**Цифрование** --- более общий термин, чем *векторизация*. Для обозначения процесса создания векторных объектов необходимо употреблять термин *векторизация*.\n:::\n\n## Пространственные отношения\n\nОтношение\n\n:   Свойство двух или более объектов, выраженное в наличии или отсутствии определенной связи между ними.\n\nПространственное отношение\n\n:   Отношение пространственных объектов, которое зависит от их местоположения.\n\n::: callout-note\n## Предикат\n\nФормальным представлением отношения является **предикат** --- функция, определенная на множестве объектов и принимающая для их упорядоченного набора значение **1** (`ИСТИНА`) или **0** (`ЛОЖЬ`). Предикаты пространственных отношений называются пространственными.\n:::\n\n## Пространственные отношения\n\nК основным видам пространственных отношений относятся:\n\n1.  **Метрические** --- определяются расстояниями между объектами.\n\n2.  **Топологические** --- определяются пересечениями объектов.\n\n3.  **Дирекционные** --- определяются направлениями между объектами\n\n::: callout-note\n## Пространственные предикаты\n\nФункции, которые устанавливают наличие метрических, топологических и дирекционных отношений, являются пространственными предикатами.\n:::\n\n## Расстояния\n\n::: columns\n::: {.column width=\"50%\"}\n#### Евклидово расстояние\n\nИспользуется в плоских прямоугольных системах координат\n\n$$\nd(A,B) = \\sqrt{(x_A - x_B)^2 + (y_A - y_B)^2}\n$$\n\n::: callout-warning\n## Ограничения\n\nЕвклидово расстояние наследует искажения проекции, а также предполагает, что объекты доступны напрямую.\n:::\n:::\n\n::: {.column width=\"50%\"}\n![](images/dist_euc.svg){fig-align=\"center\" width=\"70%\"}\n:::\n:::\n\n## Расстояния\n\n::: columns\n::: {.column width=\"50%\"}\n#### Манхэттенское расстояние\n\nАппроксимирует реальное расстояние между точками в транспортных сетях с ортогональной планировкой.\n\n$$\nd(A,B) = |x_A - x_B| + |y_A - y_B|\n$$\n\n::: callout-warning\n## Ограничения\n\nДаёт преимущества только в том случае когда дорожная сеть ориентирована по направлениям осей $X$ и $Y$.\n:::\n:::\n\n::: {.column width=\"50%\"}\n![](images/dist_manh.svg){width=\"70%\" fig-align=\"center\"}\n:::\n:::\n\n## Расстояния\n\n::: columns\n::: {.column width=\"50%\"}\n#### Геодезические расстояние\n\nКратчайшее расстояние между точками на поверхности эллипсоида. Для сферы:\n\n$$\nd(A,B) = \\\\ \\arccos ( \n\\sin \\phi_A \\sin \\phi_B + \\\\ \n\\cos \\phi_A \\cos \\phi_B \\cos(\\lambda_A - \\lambda_B))\n$$\n:::\n\n::: {.column width=\"50%\"}\n![](images/dist_geo.svg){fig-align=\"center\" width=\"75%\"}\n:::\n:::\n\n::: callout-note\n## Геодезическая линия и ортодромия\n\nЛиния кратчайшего расстояния *на эллипсоиде* --- **геодезическая**.\\\nЛиния кратчайшего расстояния *на сфере* --- **ортодромия.**\n:::\n\n## Метрические отношения\n\n**Метрические отношения** устанавливают расстояния между объектами с использованием выбранной метрики.\n\n![](images/dist_all.svg){width=\"100%\"}\n\n::: callout-note\n## Метрики\n\nДля оценки расстояний может использоваться множество других метрик. Они не исчерпываются приведенными примерами.\n:::\n\n## Топологические отношения\n\nТопологические отношения можно описать в терминах пересечения трех областей каждого объекта [@egenhofer1991]:\n\n::: columns\n::: {.column width=\"40%\"}\n-   Внутренняя область ($A^o$)\n\n-   Граница ($\\partial A$)\n\n-   Внешняя область ($A^-$)\n:::\n\n::: {.column width=\"60%\"}\n![](images/egenhofer.svg){fig-align=\"left\" width=\"70%\"}\n:::\n:::\n\nМатрица Эгенхофера **9-IM** содержит 0 или 1 в зависимости от наличия или отсутствия пересечения:\n\n$$\n\\begin{bmatrix}\nA^o  \\cap B^o \\ne \\emptyset   &   A^o \\cap \\partial{B} \\ne \\emptyset & A^o \\cap B^- \\ne \\emptyset \\\\\n\\partial{A} \\cap B^o \\ne \\emptyset   &    \\partial{A} \\cap \\partial{B} \\ne \\emptyset  &  \\partial{A} \\cap B^- \\ne \\emptyset \\\\\nA^- \\cap B^o \\ne \\emptyset    &    A^- \\cap \\partial{B} \\ne \\emptyset   &   A^-  \\cap B^- \\ne \\emptyset\n\\end{bmatrix}\n$$\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"60%\"}\n\nНе пересекает\n\n:   Внутренняя область и граница **A** не имеют пересечений с внутренней областью и границей **B**\n\n$$\n\\begin{bmatrix} \n    0 & 0 & \\bf{1} \\\\\n    0 & 0 & \\bf{1} \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что объекты никак не соприкасаются в пространстве.\n:::\n:::\n\n::: {.column width=\"40%\"}\n![](images/topo_disjoint.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"60%\"}\n\nРавен\n\n:   Границы, внутренние и внешние области **A** пересекаются с *аналогичными* элементами **B**\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & 0 & 0 \\\\\n    0 & \\bf{1} & 0 \\\\\n    0 & 0 & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что объекты совпадают.\n:::\n:::\n\n::: {.column width=\"40%\"}\n![](images/topo_equals.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"60%\"}\n\nПерекрывает\n\n:   Все компоненты **A** пересекаются со всеми компонентами **B**\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что объекты имеют частичное перекрытие.\n:::\n:::\n\n::: {.column width=\"40%\"}\n![](images/topo_overlaps.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"60%\"}\n\nКасается\n\n:   Внутренняя область и граница **A** не пересекатся с внутренней областью **B** и наоборот.\n\n$$\n\\begin{bmatrix} \n    0 & 0 & \\bf{1} \\\\\n    0 & \\bf{1} & \\bf{1} \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что объекты касаются друг друга снаружи.\n:::\n:::\n\n::: {.column width=\"40%\"}\n![](images/topo_touches.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"65%\"}\n\nПокрывает\n\n:   Внешняя область **A** не пересекается с границей и внутренней областью **B**, а граница **A** не пересекается с внутренней областью **B**.\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n    0 & \\bf{1} & \\bf{1} \\\\\n    0 & 0 & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что один объект содержит внутри себя другой объект, который касается его границы.\n:::\n:::\n\n::: {.column width=\"35%\"}\n![](images/topo_covers.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"65%\"}\n\nПокрыт\n\n:   Внешняя область **B** не пересекается с границей и внутренней областью **A**, а граница **B** не пересекается с внутренней областью **A**.\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & 0 & 0 \\\\\n    \\bf{1} & \\bf{1} & 0 \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что один объект содержится внутри другого объекта и касается его границы.\n:::\n:::\n\n::: {.column width=\"35%\"}\n![](images/topo_covered.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"65%\"}\n\nСодержит\n\n:   Внешняя область и граница **A** не пересекается с границей и внутренней областью **B**, остальные пересечения присутствуют.\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n    0 & 0 & \\bf{1} \\\\\n    0 & 0 & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что один объект содержит внутри себя другой объект.\n:::\n:::\n\n::: {.column width=\"35%\"}\n![](images/topo_contains.svg){width=\"80%\"}\n:::\n:::\n\n## Топологические отношения\n\n::: columns\n::: {.column width=\"65%\"}\n\nВнутри\n\n:   Внешняя область и граница **B** не пересекается с границей и внутренней областью **A**, остальные пересечения присутствуют.\n\n$$\n\\begin{bmatrix} \n    \\bf{1} & 0 & 0 \\\\\n    \\bf{1} & 0 & 0 \\\\\n    \\bf{1} & \\bf{1} & \\bf{1} \\\\\n\\end{bmatrix}\n$$\n\n::: callout-note\n## Применение\n\nИспользуется чтобы установить, что один объект содержится внутри другого объекта.\n:::\n:::\n\n::: {.column width=\"35%\"}\n![](images/topo_within.svg){width=\"70%\"}\n:::\n:::\n\n## Топологические отношения\n\nПересекает\n\n:   Внутренняя область или граница **A** пересекается с внутренней областью или границей **B**.\n\n![](images/topo_all.svg){fig-align=\"center\" width=\"100%\"}\n\n## Дирекционные отношения\n\n::: columns\n::: {.column width=\"50%\"}\n**Угловая модель** базируется на вычислении угла направления с точки **A** в точку **B**.\n\n-   Как правило используется дирекционный угол или азимут.\n\n::: callout-caution\n## Ограничения\n\nПрименима только для точечных объектов\n:::\n:::\n\n::: {.column width=\"50%\"}\n![](images/dir_ang.svg){width=\"70%\"}\n:::\n:::\n\n## Дирекционные отношения\n\n::: columns\n::: {.column width=\"60%\"}\n**Прямоугольная модель** разделяет плоскость на 9 секторов относительно прямоугольника, ограничивающего объект.\n\n-   Используется минимальный ограничивающий прямоугольник со сторонами, параллельными осям координат.\n\n::: callout-caution\n## Ограничения\n\nДает качественную оценку направления по сторонам света\n:::\n:::\n\n::: {.column width=\"40%\"}\n![](images/dir_mbr.svg){width=\"100%\"}\n:::\n:::\n\n## Дирекционные отношения\n\n::: columns\n::: {.column width=\"50%\"}\n**Проективная модель** используется для оценки направления на третий объект **C** относительно двух других объектов **A** и **B**.\n\n-   Плоскость делится на 4 \"конуса\", а также область между объектами.\n\n::: callout-caution\n## Ограничения\n\nДает качественную оценку направления и применяется для *движущихся* объектов\n:::\n:::\n\n::: {.column width=\"50%\"}\n![](images/dir_proj.svg){width=\"100%\"}\n:::\n:::\n\n## Словарик\n\n::: columns\n::: {.column width=\"50%\" style=\"color: blue; text-align: end;\"}\nГеографический справочник\n\nАдресный локатор\n\nГеокодирование\n\nВекторизация\n\nЦифрование\n\nПространственное отношение\n\nЕвклидово расстояние\n\nГеодезическое расстояние\n\nМетрическое отношение\n\nТопологическое отношение\n\nДирекционное отношение\n:::\n\n::: {.column width=\"50%\" style=\"color: red\"}\nGazetteer\n\nAddress locator\n\nGeocoding\n\nVectorization\n\nDigitizing\n\nSpatial relation\n\nEuclidean distance\n\nGeodesic distance\n\nMetric relation\n\nTopological relation\n\nDirectional relation\n:::\n:::\n\n## Сайт курса\n\n![](images/site.png)\n\n<https://tsamsonov.github.io/gis-course/>\n\n## Библиография\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}