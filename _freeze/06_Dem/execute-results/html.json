{
  "hash": "0f482fdfbbc20f3759eee8871304b43a",
  "result": {
    "markdown": "---\ntitle: \"Цифровое моделирование рельефа\"\nsubtitle: \"Основы геоинформатики: лекция 6\"\ndate: 03/24/2023\ndate-format: long\nauthor: \"Самсонов Тимофей Евгеньевич\"\nexecute:\n  echo: false\n  freeze: true\nengine: knitr\nformat:\n  revealjs: \n    theme: [default, custom.scss]\n    margin: 0.2\n    slide-number: true\n    footer: \"Самсонов Т. Е. Основы геоинформатики: курс лекций для студентов географического факультета МГУ\"\n    header-includes: <link rel=\"stylesheet\" media=\"screen\" href=\"https://fontlibrary.org//face/pt-sans\" type=\"text/css\"/>\nbibliography: references.yaml\nmainfont: PT Sans\n---\n\n\n\n## Цифровая модель рельефа\n\nЦифровая модель рельефа (ЦМР)\n\n:   Покрытие, функция которого возвращает отметку высоты земной поверхности.\n\nПокрытие [@ogc-07-011:2005]\n\n:   Пространственный объект, который действует как **функция**, возвращающая значения\n\n    -   в пределах своей *области значений* (атрибутивного домена);\n\n    -   в пределах своей *области определения* (пространственного, временного или пространственно-временного домена);\n\n    для любой *прямой позиции* --- координат в системе координат покрытия.\n\n## Растровая ЦМР\n\n::: columns\n::: {.column width=\"50%\"}\nНаиболее часто для представления ЦМР используются **растровые покрытия**.\n\nВ качестве *функции покрытия* используется билинейная, бикубическая и прочие методы интерполяции.\n\nСправа изображен фрагмент растровой ЦМР. Окрестность $3 \\times 3$.\n:::\n\n::: {.column width=\"50%\"}\n![](images/dem.svg){width=\"100%\"}\n:::\n:::\n\n## Растровая ЦМР --- пример\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.10.2, GDAL 3.4.2, PROJ 8.2.1; sf_use_s2() is TRUE\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nterra 1.7.29\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tidyterra'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-1-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Геоморфометрия\n\n**Геоморфометрия** --- геометрический анализ *земной* *поверхности*.\n\nРаспространенные задачи геоморфометрии включают:\n\n1.  Вычисление локальных морфометрических величин.\n2.  Выделение форм и элементов форм рельефа.\n3.  Гидрологический и топоклиматический анализ.\n\nДля представления поверхности как правило используется ЦМР.\n\n::: callout-note\n## Применение\n\nМетоды геоморфометрии могут применяться к рельефу любой поверхности, не только земной. Например, градиент (скорость изменения) может быть вычислен как для отметок высот, так и для температур.\n:::\n\n## Аппроксимация поверхности\n\n::: columns\n::: {.column width=\"50%\"}\nДля вычисления производных поверхность локально аппроксимируется.\n\nНапример, в методе **Эванса** [@evans:1980] используется функция 2 степени:\n\n$$\nZ(x,y) = \\\\ Ax^2 + By^2 + Cxy + Dx +Ey + F\n$$\n\n::: callout-tip\n## Узлов больше чем коэффициентов\n\nПоэтому поверхность не проходит через узлы, а даёт общий тренд. Устойчивость к случайным ошибкам в данных повышается.\n:::\n:::\n\n::: {.column width=\"50%\"}\n![](images/dem_surface.svg){width=\"100%\"}\n:::\n:::\n\n## Производные поверхности\n\n::: columns\n::: {.column width=\"50%\"}\n**Производные** поверхности имеют важнейшее значение для анализа рельефа:\n\n$$\n\\frac{\\partial Z}{\\partial x} = 2Ax + Cy + D \\rightarrow Z_x \\\\\n\\frac{\\partial Z}{\\partial y} = 2By + Cx + E \\rightarrow Z_y\n$$\n\nПри вычислении в центральном узле окрестности:\n\n$$\nZ_x (0,0) = D; \\ \\ Z_y (0,0) = E\n$$\n:::\n\n::: {.column width=\"50%\"}\n![](images/dem_surface.svg){width=\"100%\"}\n:::\n:::\n\n## Морфометрические величины\n\n::: columns\n::: {.column width=\"50%\"}\nМорфометрические величины, рассчитываемые для узла сетки называются локальными.\n\n**Уклон (**$S$**) и угол наклона (**$\\phi$**)**:\n\n$$\nS = \\sqrt{Z_x^2 + Z_y^2}; \\ \\phi = \\arctan(S)\n$$\n\n**Экспозиция**:\n\n$$\n\\theta = \\pi - \\arctan \\Big(\\frac{Z_y}{Z_x}\\Big) + \\frac{\\pi}{2} \\Big(\\frac{Z_x}{|Z_x|}\\Big)\n$$\n:::\n\n::: {.column width=\"50%\"}\n![](images/dem_surface.svg){width=\"100%\"}\n:::\n:::\n\n## Морфометрические величины\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-2-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Морфометрические величины\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-3-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Морфометрические величины\n\n**Кривизна кривой** обратно пропорциональна радиусу касательной окружности $r$ --- *радиусу кривизны*.\n\n-   чем больше радиус, тем меньше кривизна;\n\n-   выпуклые и вогнутые изгибы различаются знаком кривизны;\n\n-   единица измерения кривизны обычно $1/м$.\n\n![](images/curv.svg){width=\"100%\"}\n\n## Морфометрические величины\n\n::: columns\n::: {.column width=\"50%\"}\n**Плановая кривизна**:\n\n$$\nK_{p} = \\frac{Z_{xx} \\color{red}{Z_x^2 +} 2Z_{xy} Z_x Z_y + Z_{yy} \\color{red}{Z_y^2} }{pq^{3/2}}\n$$\n\n::: callout-tip\n## Интерпретация\n\nКривизна изолинии поверхности в точке. Положительные значения соответствуют областям конвергенции (тальвеги), отрицательные --- дивергенции (хребты).\n:::\n:::\n\n::: {.column width=\"50%\"}\n**Профильная кривизна**:\n\n$$\nK_{c} = \\frac{Z_{xx} \\color{blue}{Z_y^2 -} 2Z_{xy} Z_x Z_y + Z_{yy} \\color{blue}{Z_x^2} }{pq^{3/2}}\n$$\n\n::: callout-tip\n## Интерпретация\n\nКривизна склона в направлении максимального уклона. Положительные значению соответствуют увеличению уклона, отрицательные --- уменьшению.\n:::\n:::\n:::\n\n$\\frac{\\partial^2 Z}{\\partial x^2} = 2A \\rightarrow Z_{xx}; \\  \\frac{\\partial^2 Z}{\\partial y^2} = 2B \\rightarrow Z_{yy}; \\ \\frac{\\partial^2 Z}{\\partial x \\partial y} = C \\rightarrow Z_{xy}$\n\n$p = Z_x^2 + Z_y^2; \\ q = p + 1$\n\n## Морфометрические величины\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-4-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Морфометрические величины\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-5-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Интенсивность отражения света\n\nВ **модели** **Ламберта** зависит от угла между вектором **нормали** к поверхности $\\textbf N$ и вектором направления на источник света $\\textbf L$:\n\n::: columns\n::: {.column width=\"55%\"}\n$$\nI = \\cos \\alpha = \\frac{(\\textbf L, \\textbf N)}{||\\textbf N||}\n$$\n\n$\\textbf N = \\big\\{-Z_x, -Z_y, 1 \\big\\}$\n\n$\\textbf L = \\begin{cases} \\cos(h) \\cos(A),\\\\ \\cos(h) \\sin(A),\\\\ \\sin(h) \\end{cases}$\n\n$(\\textbf L, \\textbf N)$ --- скалярное произведение;\n\n$A, \\ h$ --- азимут и высота источника света (Солнца).\n:::\n\n::: {.column width=\"45%\"}\n![](images/dem_lighting.svg){width=\"90%\"}\n:::\n:::\n\n## Аналитическая отмывка\n\nВизуализация интенсивности отраженного света.\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-6-1.png){fig-align='left' width=576}\n:::\n:::\n\n\n\n## Аналитическая отмывка\n\n*Отвесная* отмывка подчеркивает линии хребтов.\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-7-1.png){fig-align='left' width=576}\n:::\n:::\n\n\n\n## Аналитическая отмывка\n\nНаиболее наглядна комбинация боковой и отвесной отмывки.\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-8-1.png){fig-align='left' width=576}\n:::\n:::\n\n\n\n## Гидрологический анализ ЦМР\n\n**Гидрологический анализ ЦМР** --- совокупность методов обработки ЦМР, связанных с анализом и моделированием геометрических условий распределения поверхностного стока.\n\nРаспространенные задачи гидрологического анализа включают:\n\n1.  Определение направлений стока.\n2.  Вычисление площади водосбора.\n3.  Построение сети потенциальных водотоков.\n4.  Построение границ бассейнов.\n\n::: callout-note\n## Предварительная подготовка ЦМР\n\nДля гидрологического анализа играют очень важную роль процедуры предварительной подготовки ЦМР, такие как *заполнение замкнутых понижений*.\n:::\n\n## Направление стока\n\n**Направление стока** указывает распределение стока по одному или множеству направлений.\n\n::: columns\n::: {.column width=\"50%\"}\nВ методе **D8** [@OCallaghan:1984bu] весь сток направляется в направлении пикселя с максимальным уклоном.\n\n-   Направления кодируются числами вида $2^n$.\n\n-   Код `0` используется для бессточных пикселей.\n\n-   Направление стока строго однозначно.\n:::\n\n::: {.column width=\"50%\"}\n![](images/d8.svg){width=\"100%\"}\n:::\n:::\n\n## Направление стока\n\n**Направление стока** указывает распределение стока по одному или множеству направлений.\n\n::: columns\n::: {.column width=\"50%\"}\nВ методе **D8** [@OCallaghan:1984bu] весь сток направляется в направлении пикселя с максимальным уклоном.\n\n-   Направления кодируются числами вида $2^n$.\n\n-   Код `0` используется для бессточных пикселей.\n\n-   Направление стока строго однозначно.\n:::\n\n::: {.column width=\"50%\"}\n![Пример растра направлений стока](images/d8_ex.svg){width=\"100%\"}\n:::\n:::\n\n## Направление стока\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-10-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Аккумуляция стока\n\n**Аккумуляция стока ---** количественный показатель, аппроксимирующий площадь бассейна.\n\n::: columns\n::: {.column width=\"50%\"}\nМожет быть выражена в:\n\n-   *количестве* дренируемых пикселей --- сток из которых попадает в данный пиксель;\n\n-   *суммарной площади* дренируемых пикселей.\n\n-   *суммарной площади* дренируемых пикселей, нормированной на их ширину перпендикулярно направлению стока.\n:::\n\n::: {.column width=\"50%\"}\n![Пример растра аккумуляции стока](images/acc.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n**Аккумуляция стока ---** количественный показатель, аппроксимирующий площадь бассейна.\n\n::: columns\n::: {.column width=\"50%\"}\nАккумуляция в $j$-м пикселе:\n\n$$\nA_j = k + \\sum_{i=1}^k A_i,\n$$\n\n-   $k$ --- количество соседних пикселей, сток из которых попадает в $j$-й;\n\n-   $A_i$ --- величина аккумуляции стока в $i$-м пикселе.\n:::\n\n::: {.column width=\"50%\"}\n![Пример растра аккумуляции стока](images/acc.svg){alt=\"Пример растра аккумуляции стока\" width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 1](images/acc_0.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 2](images/acc_1.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n3.  Повторять шаг 2 до тех пор, пока $A_j$ не будет известно для всех пикселей ЦМР.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 3](images/acc_2.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n3.  Повторять шаг 2 до тех пор, пока $A_j$ не будет известно для всех пикселей ЦМР.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 4](images/acc_3.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n3.  Повторять шаг 2 до тех пор, пока $A_j$ не будет известно для всех пикселей ЦМР.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 5](images/acc_4.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n3.  Повторять шаг 2 до тех пор, пока $A_j$ не будет известно для всех пикселей ЦМР.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 6](images/acc_5.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n::: columns\n::: {.column width=\"50%\"}\nАлгоритм вычисления:\n\n1.  Записать $A_j=0$ во все пиксели, не имеющие входящего стока.\n2.  Вычислить $A_j = k + \\sum_{i=1}^k A_i$ для всех пикселей, у которых $A_i$ *определено для всех входящих пикселей*.\n3.  Повторять шаг 2 до тех пор, пока $A_j$ не будет известно для всех пикселей ЦМР.\n:::\n\n::: {.column width=\"50%\"}\n![Шаг 7](images/acc_6.svg){width=\"100%\"}\n:::\n:::\n\n## Аккумуляция стока\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-11-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Потенциальные водотоки\n\n**Потенциальные водотоки ---** линии с высокой аккумуляцией стока.\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Выделяют пиксели, аккумуляция стока в которых превышает заданную величину. На рисунке справа представлен пример для $A \\geq 2$.\n:::\n\n::: {.column width=\"50%\"}\n![Растровая маска потенциальных водотоков](images/str.svg){width=\"100%\"}\n:::\n:::\n\n## Потенциальные водотоки\n\n**Потенциальные водотоки ---** линии с высокой аккумуляцией стока.\n\n::: columns\n::: {.column width=\"50%\"}\n1.  Выделяют пиксели, аккумуляция стока в которых превышает заданную величину. На рисунке справа представлен пример для $A \\geq 2$.\n2.  Выполняют трассировку линий по узлам выделенных пикселей с использованием растра направлений стока.\n:::\n\n::: {.column width=\"50%\"}\n![Потенциальные водотоки](images/streams.svg){width=\"100%\"}\n:::\n:::\n\n## Потенциальные водотоки\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-12-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Потенциальные водотоки\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-13-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Дренажный граф\n\n::: columns\n::: {.column width=\"50%\"}\n**Дренажный граф** --- частный случай сети потенциальных водотоков, который получается при $A \\geq 0$, а каждая линия соответствует одной связи в растре направлений стока.\n\n::: callout-tip\n## Особенность\n\nДренажный граф представляет полную систему связей между ячейками ЦМР.\n:::\n:::\n\n::: {.column width=\"50%\"}\n![Дренажный граф](images/drainage.svg){alt=\"Дренажный граф\" width=\"100%\"}\n:::\n:::\n\n## Бассейн\n\n::: columns\n::: {.column width=\"50%\"}\n**Бассейн** получается путём поиска по модели *направлений стока* всех пикселей, сток из которых попадает в указанный пиксель.\n\n::: callout-important\n## Важно\n\nОбычно на карте указывают точку для определения границы бассейна. Если она попала в пиксель с низкой аккумуляцией стока, то будет выделен бассейн малой площади.\n:::\n:::\n\n::: {.column width=\"50%\"}\n![Бассейн](images/watershed.svg){width=\"100%\"}\n:::\n:::\n\n## Бассейн\n\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![](06_Dem_files/figure-html/unnamed-chunk-14-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n## Словарик\n\n::: columns\n::: {.column width=\"50%\" style=\"color: blue; text-align: end;\"}\nЦифровая модель рельефа\n\nПоверхность\n\nГеоморфометрия\n\nПроизводная\n\nУклон\n\nЭкспозиция\n\nКривизна\n\nОтмывка\n\nНаправление стока\n\nАккумуляция стока\n\nБассейн / водосбор\n:::\n\n::: {.column width=\"50%\" style=\"color: red\"}\nDigital elevation model\n\nSurface\n\nGeomorphometry\n\nDerivative\n\nSlope\n\nAspect\n\nCurvature\n\nHillshading\n\nFlow direction\n\nFlow accumulation\n\nBasin / watershed\n:::\n:::\n\n## Библиография\n",
    "supporting": [
      "06_Dem_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}