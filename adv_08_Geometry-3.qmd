---
title: "Геометрические операции — III"
subtitle: "Геоинформатика I. Базы пространственных данных"
date: today
date-format: long
author: "Самсонов Тимофей Евгеньевич"
execute:
  echo: false
  freeze: true
engine: knitr
format:
  revealjs: 
    theme: [default, custom.scss]
    margin: 0.2
    width: 1280
    height: 720
    slide-number: true
    footer: "Самсонов Т. Е. Геоинформатика: курс лекций"
    header-includes: <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/pt-sans" type="text/css"/>
bibliography: references.yaml
mainfont: PT Sans
---

## Основные операции

::: columns
::: {.column width="50%"}
1.  Расстояния между объектами
2.  Периметр линии
3.  Площадь полигона
4.  Точка относительно прямой
5.  Точка относительно отрезка
6.  Пересечение отрезков
7.  Точка в полигоне
8.  Ограничивающий прямоугольник
9.  Выпуклая оболочка
10. Минимальный прямоугольник
:::

::: {.column width="50%"}
1.  Пересечение множества отрезков
2.  **Оверлей полигонов**
3.  **Слияние линий и полигонов**
4.  **Полигонизация линий**
5.  **Буферная зона**
6.  **Триангуляция Делоне**
7.  **Диаграмма Вороного**
8.  **Скелет и срединная ось полигона**
9.  **Центроид и точка на поверхности**
10. **Вогнутая оболочка**
:::
:::

## Оверлей

**Оверлей** --- пространственное наложение двух или более пространственных объектов, при котором образуется их геометрическая и атрибутивная композиция.

![](images/overlay.svg){width="100%"}

::: callout-warning
## Проблема

Для выполнения оверлея неэффективно хранить полигоны как коллекции отрезков. В этом случае затруднительно получать границы образуемых в процессе оверлея областей.
:::

## Разбиение множества

Разбиение множества

:   Представление множества в виде объединения произвольного числа попарно неперескающихся непустых подмножеств

::: columns
::: {.column width="70%"}
Семейство множеств $Y = \{Y_\alpha\}$, где $\alpha \in A$ --- множество индексов, является разбиением множества $X$, если:

-   $Y$ не содержит пустого множества: $\varnothing \notin Y$

-   Объединение множеств, входящих в $Y$, равно $X$:

    $$
    \bigcup Y_\alpha = X
    $$

-   Пересечение любых различных множеств $Y$ пусто:

    $$
    \forall~\alpha,\beta \in A,~\alpha \neq \beta \Longrightarrow Y_\alpha \cap Y_\beta = \varnothing
    $$
:::

::: {.column width="30%"}
![](images/set_subdivision.svg){width="100%"}
:::
:::

## Разбиение плоскости

::: columns
::: {.column width="60%"}
::: callout-warning
## Проблема

Плоскость нельзя разбить множествами, которые являются *замыканиями* (включают собственную границу), т.к. в этом случае они будут пересекаться.
:::

::: callout-tip
## Решение

Представить разбиение в виде совокупности *вершин*, *ребер* и *граней*. Эти подмножества являются *открытыми*: ребра не включают вершины, а грани не включают вершины и ребра.
:::

$$Y = V \bigcup E \bigcup F,$$

где подмножества $V = \{v_i\}$ --- вершины, $E = \{e_j\}$ --- ребра, $F = \{f_k\}$ --- грани.
:::

::: {.column width="40%"}
![](images/set_subdivision_details.svg){width="100%"}
:::
:::

## Полуребра

При обработке разбиений удобно представить каждое ребро $e_j$ в виде двух полуребер $\vec{e}_{j,0}$ и $\vec{e}_{j,1}$, имеющих противоположные направления.

::: columns
::: {.column width="70%"}
1.  Полуребра называются *близнецами*:

    $$
    \vec{e}_{j,0} = \texttt{twin}(\vec{e}_{j,1});~\vec{e}_{j,1} = \texttt{twin}(\vec{e}_{j,0})
    $$

2.  Каждое полуребро входит в состав границы только одной грани.

3.  Полуребро направлено таким образом, что грань находится *слева* от него.

    -   полуребра *внешних* границ упорядочены *против* часовой стрелки;

    -   полуребра *внутренних* границ (дырок) упорядочены *по* часовой стрелке.
:::

::: {.column width="30%"}
![](images/halfedges.svg){width="100%"}
:::
:::

## Двусвязный список ребер

Структура данных, которая опирается на следующие классы объектов:

**Вершина** $v$

|                     |                                              |
|---------------------|----------------------------------------------|
| $(x,y)$             | координаты                                   |
| $\texttt{halfedge}$ | полуребро, для которого $v$ является началом |

**Грань** $f$

|                  |                                                          |
|--------------|----------------------------------------------------------|
| $\texttt{outer}$ | любое полуребро внешней границы                          |
| $\texttt{inner}$ | список любых полуребер дырок (по одному на каждую дырку) |

::: callout-tip
Для *неограниченной* области $\texttt{outer_component} = \varnothing$, для полигона *без дырок* $\texttt{inner_components} = \varnothing$
:::

## Двусвязный список ребер

**Полуребро** $\overrightarrow e$

|                   |                                        |
|-------------------|----------------------------------------|
| $\texttt{origin}$ | вершина, являющаяся началом полуребра  |
| $\texttt{twin}$   | полуребро-близнец                      |
| $\texttt{face}$   | инцидентная грань                      |
| $\texttt{next}$   | следующее полуребро в $\texttt{face}$  |
| $\texttt{prev}$   | предыдущее полуребро в $\texttt{face}$ |

::: callout-note
## Объем данных

Размер вершины и полуребра в памяти известен заранее. Размер грани зависит от количества дырок.
:::

::: callout-tip
## А конец полуребра?

Конец полуребра можно получить как $\texttt{origin}(\texttt{twin}(\overrightarrow{e}))$
:::

## Библиография
